<p-toast></p-toast>

<div class="auth-shell">
  <p-card styleClass="auth-card auth-card-scroll">
    <ng-template pTemplate="header">
      <div class="auth-header">
        <div class="brand" aria-hidden="true">
          <img src="assets/logo-register.webp" alt="TimeLogic" />
        </div>
        <h1 class="title">Recuperar contraseña</h1>
        <p class="subtitle">Te enviaremos un enlace para restablecerla</p>
      </div>
    </ng-template>

    <!-- Mensaje de error global (si decides mostrar alguno distinto del genérico) -->
    <p-message
      *ngIf="errorMessage"
      severity="error"
      [text]="errorMessage"
      class="message-global"
      [escape]="true"
    >
    </p-message>

    <!-- Live region para lectores de pantalla -->
    <span class="sr-only" aria-live="assertive" aria-atomic="true">
      {{ errorMessage }}
    </span>

    <form
      class="auth-form"
      [attr.aria-busy]="loading()"
      [class.is-loading]="loading()"
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
      novalidate
    >
      <!-- Email -->
      <div class="field">
        <span class="p-input-icon-left p-float-label with-separator">
          <i class="pi pi-envelope"></i>
          <input
            id="fp-email"
            pInputText
            type="email"
            formControlName="email"
            autocomplete="email"
            inputmode="email"
            autocapitalize="none"
            autocorrect="off"
            spellcheck="false"
            [attr.aria-invalid]="email.invalid || null"
            aria-describedby="fp-email-err"
            [disabled]="loading()"
            autofocus
          />
          <label for="fp-email">Correo electrónico</label>
        </span>
        <small
          id="fp-email-err"
          class="p-error"
          *ngIf="email.invalid && (email.touched || email.dirty)"
        >
          {{ getEmailError() }}
        </small>
      </div>

      <!-- Submit -->
      <button
        pButton
        type="submit"
        class="auth-submit"
        [loading]="loading()"
        [disabled]="form.invalid || loading()"
        [label]="loading() ? 'Enviando…' : 'Enviar enlace'"
      ></button>

      <!-- Volver al login -->
      <div class="back-row">
        <a routerLink="/auth/login" aria-label="Volver al inicio de sesión">
          Volver al inicio de sesión
        </a>
      </div>
    </form>

    <ng-template pTemplate="footer">
      <div class="auth-footer">
        ¿No tienes cuenta? <a routerLink="/auth/register">Regístrate</a>
      </div>
    </ng-template>
  </p-card>
</div>
